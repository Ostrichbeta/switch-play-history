import{l as ht,r as L,c as T,w as j,p as I,G as N,A as B,h as G,ab as mt,g as gt,m as ft,H as pt,_ as vt,W as yt,d as wt,U as k,Y as bt,Z as y,a0 as a,a4 as c,j as d,a5 as S,$ as Tt,V as Q,a2 as St,F as _t,a1 as E,a3 as xt}from"./index.33acd6d5.js";import{Q as Ct,a as kt}from"./QImg.607a55a8.js";import{u as Ht,v as V,e as qt,f as Mt,g as Pt,r as A,s as Dt,c as z,p as U,h as Ot,Q as Lt}from"./QSelect.8098da99.js";import{f as jt,w as H,s as It,h as Nt,x as Bt,i as Gt,y as Qt,j as Et,z as Vt,g as At,N as zt,n as Ut}from"./user-info.af6dd998.js";import{Q as Ft,a as Wt}from"./QCard.09db7d6c.js";import{Q as Rt}from"./QPage.9174f995.js";import"./i18n.cf8c36ea.js";var F=ht({name:"QTooltip",inheritAttrs:!1,props:{...Ht,...jt,...H,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{...H.transitionShow,default:"jump-down"},transitionHide:{...H.transitionHide,default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:V},self:{type:String,default:"top middle",validator:V},offset:{type:Array,default:()=>[14,14],validator:qt},scrollTarget:It,delay:{type:Number,default:0},hideDelay:{type:Number,default:0},persistent:Boolean},emits:[...Nt],setup(t,{slots:e,emit:n,attrs:r}){let o,l;const s=gt(),{proxy:{$q:u}}=s,f=L(null),w=L(!1),W=T(()=>U(t.anchor,u.lang.rtl)),R=T(()=>U(t.self,u.lang.rtl)),J=T(()=>t.persistent!==!0),{registerTick:Y,removeTick:Z}=Bt(),{registerTimeout:b}=Gt(),{transitionProps:K,transitionStyle:X}=Qt(t),{localScrollTarget:$,changeScrollEvent:tt,unconfigureScrollTarget:et}=Mt(t,D),{anchorEl:h,canShow:st,anchorEvents:p}=Pt({showing:w,configureAnchorEl:dt}),{show:at,hide:x}=Et({showing:w,canShow:st,handleShow:it,handleHide:nt,hideOnRouteChange:J,processOnMount:!0});Object.assign(p,{delayShow:lt,delayHide:rt});const{showPortal:q,hidePortal:M,renderPortal:ot}=Vt(s,f,ut,"tooltip");if(u.platform.is.mobile===!0){const i={anchorEl:h,innerRef:f,onClickOutside(g){return x(g),g.target.classList.contains("q-dialog__backdrop")&&pt(g),!0}},C=T(()=>t.modelValue===null&&t.persistent!==!0&&w.value===!0);j(C,g=>{(g===!0?Ot:A)(i)}),I(()=>{A(i)})}function it(i){q(),Y(()=>{l=new MutationObserver(()=>v()),l.observe(f.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),v(),D()}),o===void 0&&(o=j(()=>u.screen.width+"|"+u.screen.height+"|"+t.self+"|"+t.anchor+"|"+u.lang.rtl,v)),b(()=>{q(!0),n("show",i)},t.transitionDuration)}function nt(i){Z(),M(),P(),b(()=>{M(!0),n("hide",i)},t.transitionDuration)}function P(){l!==void 0&&(l.disconnect(),l=void 0),o!==void 0&&(o(),o=void 0),et(),N(p,"tooltipTemp")}function v(){Dt({targetEl:f.value,offset:t.offset,anchorEl:h.value,anchorOrigin:W.value,selfOrigin:R.value,maxHeight:t.maxHeight,maxWidth:t.maxWidth})}function lt(i){if(u.platform.is.mobile===!0){z(),document.body.classList.add("non-selectable");const C=h.value,g=["touchmove","touchcancel","touchend","click"].map(O=>[C,O,"delayHide","passiveCapture"]);B(p,"tooltipTemp",g)}b(()=>{at(i)},t.delay)}function rt(i){u.platform.is.mobile===!0&&(N(p,"tooltipTemp"),z(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),b(()=>{x(i)},t.hideDelay)}function dt(){if(t.noParentEvent===!0||h.value===null)return;const i=u.platform.is.mobile===!0?[[h.value,"touchstart","delayShow","passive"]]:[[h.value,"mouseenter","delayShow","passive"],[h.value,"mouseleave","delayHide","passive"]];B(p,"anchor",i)}function D(){if(h.value!==null||t.scrollTarget!==void 0){$.value=At(h.value,t.scrollTarget);const i=t.noParentEvent===!0?v:x;tt($.value,i)}}function ct(){return w.value===!0?G("div",{...r,ref:f,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",r.class],style:[r.style,X.value],role:"tooltip"},ft(e.default)):null}function ut(){return G(mt,K.value,ct)}return I(P),Object.assign(s.proxy,{updatePosition:v}),ot}});const _=zt(),m=Ut(),{list:Jt}=yt(_),Yt=wt({name:"GameCard",data:()=>({apple:114514,sortedList:[],sortOptions:[{label:"Game Time",value:"time"},{label:"Last Played",value:"last"},{label:"Japanese Name",value:"jpname"}],currentSortOption:{label:"Game Time",value:"time"},gameHistoryList:Jt,totalMinute:0}),methods:{timeIntervalFromNow(t){const e=new Date,n=new Date(t),r=(e-n)/1e3,o=Math.abs(r);let l;if(o<3600)l=$t("gameCards.timeInterval.withinOneHour");else if(o<86400){const s=Math.floor(o/3600);l=this.$tc(`gameCards.timeInterval.hour${r>0?"ago":"after"}`,s)}else if(o<2592e3){const s=Math.floor(o/86400);l=this.$tc(`gameCards.timeInterval.day${r>0?"ago":"after"}`,s)}else if(o<31104e3){const s=Math.floor(o/2592e3);l=this.$tc(`gameCards.timeInterval.month${r>0?"ago":"after"}`,s)}else{const s=Math.floor(o/2592e3);l=this.$tc(`gameCards.timeInterval.month${r>0?"ago":"after"}`,s)}return l},minutesToHHmm(t){const e=Math.floor(t/60),n=t%60,r=String(e).padStart(1,"0"),o=String(n).padStart(2,"0");return`${r} h ${o} m`},findEnglishName(t){try{for(const e of Object.keys(enTitleDB))if(enTitleDB[e].id==t)return enTitleDB[e].name?enTitleDB[e].name:"";return""}catch(e){return console.log(e),""}},findChineseName(t){try{for(const e of Object.keys(hkTitleDB))if(hkTitleDB[e].id==t)return hkTitleDB[e].name?hkTitleDB[e].name:"";return""}catch(e){return console.log(e),""}},onSortMethodChanged(t){switch(this.sortedList=[],t.value){case"time":this.sortedList=[...this.gameHistoryList].sort((e,n)=>n.totalPlayedMinutes-e.totalPlayedMinutes);break;case"last":this.sortedList=[...this.gameHistoryList].sort((e,n)=>new Date(n.lastPlayedAt).getTime()-new Date(e.lastPlayedAt).getTime);break;case"jpname":this.sortedList=[...this.gameHistoryList].sort((e,n)=>e.titleName.localeCompare(n.titleName,"ja"));break;default:this.sortedList=[];break}},async refreshList(){this.totalMinute=0,await m.getHistory(),this.totalMinute=m.getTotalGameTime(),m.isLogin||this.$router.push("/login")},getGameDetail(t){return _.gameDetail[t]!==void 0?_.gameDetail[t]:{lang:"ja",name:"",bannerUrl:""}}},computed:{},async mounted(){if(this.onSortMethodChanged(this.currentSortOption),!m.isLogin)this.$router.push("/login");else{if(_.list.length==0){switch(this.$i18n.locale){case"en":await m.getHistory(void 0,"en");break;case"ja":await m.getHistory(void 0,"ja");break;case"zh-Hant":await m.getHistory(void 0,"zh");break}m.isLogin||this.$router.push("/login")}this.totalMinute=m.getTotalGameTime(),this.onSortMethodChanged(this.currentSortOption)}},watch:{gameHistoryList(t,e){this.onSortMethodChanged(this.currentSortOption)}}}),Zt=["lang"],Kt=["lang"],Xt={class:"row full-width justify-around no-wrap",style:{"max-width":"400px"}},te={class:"row no-wrap items-end"},ee={class:"text-h6"},se={class:"text-h4 q-pl-sm"},ae={class:"row no-wrap items-end"},oe={class:"text-h6"},ie={class:"text-h4 q-pl-sm"},ne=a("div",{class:"text-h5 q-pl-sm"},"h",-1),le={class:"text-h4 q-pl-sm"},re=a("div",{class:"text-h5 q-pl-sm"},"m",-1),de={class:"row full-width justify-start q-px-md q-pt-md",style:{"max-width":"1200px"}},ce={class:"row full-width q-px-md q-pt-sm",style:{"max-width":"1200px"}},ue={class:"flex no-wrap full-height"},he={style:{width:"80px"},class:"column justify-center"},me={class:"column q-pl-md justify-center",style:{width:"calc(100% - 80px)"}},ge=["lang"],fe=["lang"],pe={lang:"ja"},ve={class:"row no-wrap items-center q-pt-xs"},ye=["lang"],we={class:"row full-width items-center q-pt-xs"},be={class:"col-12"},Te={class:"row no-wrap items-center q-pt-none"},Se={class:"text-body2 ellipsis q-pl-xs"};function _e(t,e,n,r,o,l){return k(),bt(Rt,{class:"column content-center items-center"},{default:y(()=>[a("div",{class:"text-h5 xs text-dark q-pt-md text-center q-pb-md",lang:t.$i18n.locale},c(t.$t("gameCards.mygames")),9,Zt),a("div",{class:"text-h3 gt-xs text-dark q-pt-lg text-center q-pb-lg",lang:t.$i18n.locale},c(t.$t("gameCards.mygames")),9,Kt),a("div",Xt,[a("div",te,[a("div",ee,[d(S,{name:"mdi-gamepad-variant-outline",size:"sm"})]),a("div",se,c(t.gameHistoryList.length),1)]),a("div",ae,[a("div",oe,[d(S,{name:"mdi-clock-outline",size:"sm"})]),a("div",ie,c(Math.floor(t.totalMinute/60)),1),ne,a("div",le,c(String(t.totalMinute%60).padStart(2,"0")),1),re])]),a("div",de,[d(Tt,{round:"",flat:"",icon:"mdi-refresh",onClick:e[0]||(e[0]=async()=>await t.refreshList())}),d(Ct),d(Lt,{class:"q-px-xs",style:{width:"200px"},outlined:"",dense:"",modelValue:t.currentSortOption,"onUpdate:modelValue":[e[1]||(e[1]=s=>t.currentSortOption=s),t.onSortMethodChanged],options:t.sortOptions,label:t.$t("gameCards.sortby"),"option-label":s=>t.$t(`gameCards.${s.value}`)},null,8,["modelValue","options","label","onUpdate:modelValue","option-label"])]),a("div",ce,[(k(!0),Q(_t,null,St(t.sortedList,s=>(k(),Q("div",{class:"col-12 col-sm-6 q-px-xs q-pb-sm",key:s},[d(Ft,{class:"my-card",style:{height:"125px"}},{default:y(()=>[d(Wt,{class:"full-height"},{default:y(()=>[a("div",ue,[a("div",he,[d(kt,{src:s.imageUrl,height:"80px",width:"80px"},null,8,["src"])]),a("div",me,[a("div",{class:"text-body1 ellipsis full-width",lang:t.getGameDetail(s.titleId).lang},[E(c(t.getGameDetail(s.titleId).name)+" ",1),d(F,null,{default:y(()=>[a("span",{lang:t.getGameDetail(s.titleId).lang},c(t.getGameDetail(s.titleId).name),9,fe)]),_:2},1024)],8,ge),a("div",{class:xt(["text-body2 ellipsis text-grey-6 full-width q-pt-none",{invisible:t.getGameDetail(s.titleId).name==s.titleName}]),lang:"ja"},[E(c(s.titleName)+" ",1),d(F,null,{default:y(()=>[a("span",pe,c(s.titleName),1)]),_:2},1024)],2),a("div",ve,[d(S,{name:"mdi-play-box-outline",size:"xs"}),a("div",{class:"text-body2 ellipsis q-pl-xs",lang:t.$i18n.locale},c(t.timeIntervalFromNow(s.lastPlayedAt)),9,ye)]),a("div",we,[a("div",be,[a("div",Te,[d(S,{name:"mdi-clock-outline",size:"xs"}),a("div",Se,c(t.minutesToHHmm(s.totalPlayedMinutes)),1)])])])])])]),_:2},1024)]),_:2},1024)]))),128))])]),_:1})}var Pe=vt(Yt,[["render",_e]]);export{Pe as default};
